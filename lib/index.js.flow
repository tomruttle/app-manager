// @flow

type AppNameType = string;
type SlotNameType = string;
type ScriptNameType = string;

export type AnalyticsErrorType = {
  eventTitle: string,
  id?: string,
};

export type AnalyticsType = {
  namespace: string,
  error: (error: AnalyticsErrorType) => any,
};

export type OptionsType = {
  importTimeout?: number,
};

export type AppType = {
  name: AppNameType,
  appPath: string,
  scripts: Array<ScriptNameType>,
};

export interface FragmentVersion3Type {
  version: 3;
  hydrate(container: HTMLDivElement, history: History, currentApp: AppType): Promise<?void>;
  mount(container: HTMLDivElement, history: History, currentApp: AppType): Promise<?void>;
  unmount(container: HTMLDivElement, history: History, currentApp: AppType): boolean;
  onStateChange(history: History, currentApp: AppType): Promise<?void>;
}

export type FragmentType = FragmentVersion3Type;

export type SlotType = {
  name: SlotNameType,
  elementClass: string,
};

export type ScriptType = {
  name: ScriptNameType,
  slots: Array<SlotNameType>,
  managed: boolean,
  load?: () => Promise<FragmentType>,
};

export type ConfigType = {|
  apps: { [app: string]: AppType },
  slots: { [slot: string]: SlotType },
  scripts: { [script: string]: ScriptType },
|};

declare export default class AppManager {
  constructor(config: ConfigType, analytics?: AnalyticsType, options?: OptionsType): AppManager,
  onStateChange: () => Promise<boolean>,
  init: () => Promise<boolean>,
}
